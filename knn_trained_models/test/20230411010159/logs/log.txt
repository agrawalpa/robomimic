
============= Initialized Observation Utils with Obs Spec =============

using obs modality: low_dim with keys: ['robot0_gripper_qpos', 'object', 'robot0_eef_pos', 'robot0_eef_quat']
using obs modality: rgb with keys: []
using obs modality: depth with keys: []
using obs modality: scan with keys: []

============= Loaded Environment Metadata =============
obs key object with shape (14,)
obs key robot0_eef_pos with shape (3,)
obs key robot0_eef_quat with shape (4,)
obs key robot0_gripper_qpos with shape (2,)
Created environment with name NutAssemblySquare
Action size is 7
NutAssemblySquare
{
    "camera_depths": false,
    "camera_heights": 84,
    "camera_widths": 84,
    "control_freq": 20,
    "controller_configs": {
        "control_delta": true,
        "damping": 1,
        "damping_limits": [
            0,
            10
        ],
        "impedance_mode": "fixed",
        "input_max": 1,
        "input_min": -1,
        "interpolation": null,
        "kp": 150,
        "kp_limits": [
            0,
            300
        ],
        "orientation_limits": null,
        "output_max": [
            0.05,
            0.05,
            0.05,
            0.5,
            0.5,
            0.5
        ],
        "output_min": [
            -0.05,
            -0.05,
            -0.05,
            -0.5,
            -0.5,
            -0.5
        ],
        "position_limits": null,
        "ramp_ratio": 0.2,
        "type": "OSC_POSE",
        "uncouple_pos_ori": true
    },
    "has_offscreen_renderer": true,
    "has_renderer": false,
    "ignore_done": true,
    "render_gpu_device_id": 0,
    "reward_shaping": false,
    "robots": [
        "Panda"
    ],
    "use_camera_obs": false,
    "use_object_obs": true
}


============= Model Summary =============
KNN (
  ModuleDict()
)

SequenceDataset: loading dataset into memory...
  0%|          | 0/200 [00:00<?, ?it/s] 27%|##7       | 54/200 [00:00<00:00, 536.59it/s] 54%|#####4    | 108/200 [00:00<00:00, 525.16it/s] 80%|########  | 161/200 [00:00<00:00, 502.44it/s]100%|##########| 200/200 [00:00<00:00, 490.44it/s]
SequenceDataset: caching get_item calls...
  0%|          | 0/30154 [00:00<?, ?it/s]  3%|2         | 782/30154 [00:00<00:03, 7812.22it/s]  5%|5         | 1564/30154 [00:00<00:04, 6727.08it/s]  7%|7         | 2247/30154 [00:00<00:04, 6586.48it/s] 10%|#         | 3094/30154 [00:00<00:03, 7279.28it/s] 13%|#3        | 3932/30154 [00:00<00:03, 7658.36it/s] 16%|#6        | 4839/30154 [00:00<00:03, 8122.19it/s] 19%|#9        | 5752/30154 [00:00<00:02, 8443.16it/s] 22%|##1       | 6631/30154 [00:00<00:02, 8549.37it/s] 25%|##4       | 7490/30154 [00:00<00:02, 8162.76it/s] 28%|##7       | 8368/30154 [00:01<00:02, 8343.10it/s] 31%|###       | 9207/30154 [00:01<00:02, 7437.81it/s] 33%|###3      | 9971/30154 [00:01<00:02, 7161.33it/s] 36%|###5      | 10779/30154 [00:01<00:02, 7410.11it/s] 39%|###8      | 11654/30154 [00:01<00:02, 7785.39it/s] 42%|####1     | 12520/30154 [00:01<00:02, 8033.83it/s] 44%|####4     | 13333/30154 [00:01<00:02, 7929.06it/s] 47%|####7     | 14266/30154 [00:01<00:01, 8332.42it/s] 50%|#####     | 15174/30154 [00:01<00:01, 8549.09it/s] 53%|#####3    | 16035/30154 [00:02<00:01, 8566.62it/s] 56%|#####6    | 16896/30154 [00:02<00:01, 8575.95it/s] 59%|#####8    | 17757/30154 [00:02<00:01, 8367.84it/s] 62%|######1   | 18597/30154 [00:02<00:01, 8281.68it/s] 64%|######4   | 19428/30154 [00:02<00:01, 8225.25it/s] 67%|######7   | 20252/30154 [00:02<00:01, 8095.46it/s] 70%|######9   | 21063/30154 [00:02<00:01, 7608.26it/s] 73%|#######2  | 21892/30154 [00:02<00:01, 7798.90it/s] 75%|#######5  | 22742/30154 [00:02<00:00, 7996.27it/s] 78%|#######8  | 23616/30154 [00:02<00:00, 8210.40it/s] 81%|########1 | 24456/30154 [00:03<00:00, 8264.12it/s] 84%|########4 | 25364/30154 [00:03<00:00, 8504.64it/s] 87%|########6 | 26217/30154 [00:03<00:00, 8416.52it/s] 90%|########9 | 27104/30154 [00:03<00:00, 8544.76it/s] 93%|#########2| 27960/30154 [00:03<00:00, 8286.18it/s] 96%|#########5| 28831/30154 [00:03<00:00, 8406.75it/s] 99%|#########8| 29710/30154 [00:03<00:00, 8517.36it/s]100%|##########| 30154/30154 [00:03<00:00, 8094.83it/s]

============= Training Dataset =============
SequenceDataset (
	path=datasets/square/ph/low_dim.hdf5
	obs_keys=('object', 'robot0_eef_pos', 'robot0_eef_quat', 'robot0_gripper_qpos')
	seq_length=1
	filter_key=none
	frame_stack=1
	pad_seq_length=True
	pad_frame_stack=True
	goal_mode=none
	cache_mode=all
	num_demos=200
	num_sequences=30154
)

  0%|          | 0/100 [00:00<?, ?it/s] 11%|#1        | 11/100 [00:00<00:00, 106.45it/s] 22%|##2       | 22/100 [00:00<00:00, 96.34it/s]  32%|###2      | 32/100 [00:00<00:00, 88.25it/s] 41%|####1     | 41/100 [00:00<00:00, 76.87it/s] 49%|####9     | 49/100 [00:00<00:00, 68.97it/s] 57%|#####6    | 57/100 [00:00<00:00, 49.42it/s] 63%|######3   | 63/100 [00:01<00:00, 47.91it/s] 69%|######9   | 69/100 [00:01<00:00, 45.70it/s] 74%|#######4  | 74/100 [00:01<00:00, 43.65it/s] 79%|#######9  | 79/100 [00:01<00:00, 41.91it/s] 84%|########4 | 84/100 [00:01<00:00, 40.69it/s] 89%|########9 | 89/100 [00:01<00:00, 36.50it/s] 93%|#########3| 93/100 [00:01<00:00, 35.42it/s] 97%|#########7| 97/100 [00:02<00:00, 34.05it/s]100%|##########| 100/100 [00:02<00:00, 47.21it/s]
Train Epoch 1
{
    "Time_Data_Loading": 0.009390664100646973,
    "Time_Epoch": 0.03591223160425822,
    "Time_Log_Info": 1.659393310546875e-05,
    "Time_Process_Batch": 0.0002000888188680013,
    "Time_Train_Batch": 0.025584618250528973
}
video writes to /home/palash/robomimic/robomimic/../knn_trained_models/test/20230411010159/videos/NutAssemblySquare_epoch_1.mp4
rollout: env=NutAssemblySquare, horizon=400, use_goals=False, num_episodes=50
  0%|          | 0/50 [00:00<?, ?it/s]/home/palash/robomimic/robomimic/algo/knn.py:173: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  weights_tensor = torch.tensor(weights, dtype=torch.float32)
  2%|2         | 1/50 [00:18<14:57, 18.32s/it]  4%|4         | 2/50 [00:36<14:34, 18.22s/it]  6%|6         | 3/50 [00:55<14:28, 18.47s/it]  8%|8         | 4/50 [01:13<14:12, 18.53s/it] 10%|#         | 5/50 [01:30<13:26, 17.93s/it] 12%|#2        | 6/50 [01:47<12:47, 17.45s/it] 14%|#4        | 7/50 [02:05<12:39, 17.67s/it] 16%|#6        | 8/50 [02:21<12:04, 17.25s/it] 18%|#8        | 9/50 [02:37<11:31, 16.87s/it] 20%|##        | 10/50 [02:44<09:11, 13.78s/it] 22%|##2       | 11/50 [03:03<09:54, 15.25s/it] 24%|##4       | 12/50 [03:19<09:55, 15.66s/it] 26%|##6       | 13/50 [03:36<09:55, 16.11s/it] 28%|##8       | 14/50 [03:42<07:45, 12.93s/it] 30%|###       | 15/50 [03:59<08:10, 14.02s/it] 32%|###2      | 16/50 [04:18<08:50, 15.62s/it] 34%|###4      | 17/50 [04:27<07:26, 13.53s/it] 36%|###6      | 18/50 [04:44<07:50, 14.72s/it] 38%|###8      | 19/50 [05:08<08:59, 17.40s/it] 40%|####      | 20/50 [05:28<09:06, 18.23s/it] 42%|####2     | 21/50 [05:44<08:30, 17.59s/it] 44%|####4     | 22/50 [06:05<08:42, 18.67s/it] 46%|####6     | 23/50 [06:23<08:20, 18.54s/it] 48%|####8     | 24/50 [06:44<08:16, 19.08s/it] 50%|#####     | 25/50 [06:53<06:46, 16.24s/it] 52%|#####2    | 26/50 [07:11<06:37, 16.57s/it] 54%|#####4    | 27/50 [07:27<06:22, 16.62s/it] 56%|#####6    | 28/50 [07:44<06:03, 16.53s/it] 58%|#####8    | 29/50 [08:01<05:51, 16.75s/it] 60%|######    | 30/50 [08:18<05:38, 16.90s/it] 62%|######2   | 31/50 [08:35<05:19, 16.83s/it] 64%|######4   | 32/50 [08:49<04:48, 16.03s/it] 66%|######6   | 33/50 [08:58<03:55, 13.86s/it] 68%|######8   | 34/50 [09:17<04:05, 15.34s/it] 70%|#######   | 35/50 [09:33<03:53, 15.57s/it] 72%|#######2  | 36/50 [09:51<03:49, 16.39s/it] 74%|#######4  | 37/50 [09:58<02:54, 13.46s/it] 76%|#######6  | 38/50 [10:14<02:51, 14.29s/it] 78%|#######8  | 39/50 [10:30<02:44, 14.93s/it] 80%|########  | 40/50 [10:48<02:37, 15.80s/it] 82%|########2 | 41/50 [11:06<02:27, 16.40s/it] 84%|########4 | 42/50 [11:23<02:12, 16.52s/it] 86%|########6 | 43/50 [11:41<01:58, 16.90s/it] 88%|########8 | 44/50 [11:51<01:29, 14.97s/it] 90%|######### | 45/50 [12:07<01:16, 15.29s/it] 92%|#########2| 46/50 [12:24<01:03, 15.81s/it] 94%|#########3| 47/50 [12:41<00:48, 16.02s/it] 96%|#########6| 48/50 [12:52<00:28, 14.50s/it] 98%|#########8| 49/50 [13:11<00:15, 15.96s/it]100%|##########| 50/50 [13:19<00:00, 13.55s/it]100%|##########| 50/50 [13:19<00:00, 15.99s/it]

Epoch 1 Rollouts took 15.984077711105346s (avg) with results:
Env: NutAssemblySquare
{
    "Horizon": 350.88,
    "Return": 0.24,
    "Success_Rate": 0.24,
    "Time_Episode": 13.320064759254455,
    "time": 15.984077711105346
}
save checkpoint to /home/palash/robomimic/robomimic/../knn_trained_models/test/20230411010159/models/model_epoch_1_NutAssemblySquare_success_0.24.pth

Epoch 1 Memory Usage: 2044 MB

finished run successfully!
