
============= Initialized Observation Utils with Obs Spec =============

using obs modality: low_dim with keys: ['robot0_eef_pos', 'robot0_eef_quat', 'object', 'robot0_gripper_qpos']
using obs modality: rgb with keys: []
using obs modality: depth with keys: []
using obs modality: scan with keys: []

============= Loaded Environment Metadata =============
obs key object with shape (14,)
obs key robot0_eef_pos with shape (3,)
obs key robot0_eef_quat with shape (4,)
obs key robot0_gripper_qpos with shape (2,)
[robosuite WARNING] No private macro file found! (macros.py:53)
[robosuite WARNING] It is recommended to use a private macro file (macros.py:54)
[robosuite WARNING] To setup, run: python /home/pa1077/robosuite/robosuite/scripts/setup_macros.py (macros.py:55)
Created environment with name NutAssemblySquare
Action size is 7
NutAssemblySquare
{
    "camera_depths": false,
    "camera_heights": 84,
    "camera_widths": 84,
    "control_freq": 20,
    "controller_configs": {
        "control_delta": true,
        "damping": 1,
        "damping_limits": [
            0,
            10
        ],
        "impedance_mode": "fixed",
        "input_max": 1,
        "input_min": -1,
        "interpolation": null,
        "kp": 150,
        "kp_limits": [
            0,
            300
        ],
        "orientation_limits": null,
        "output_max": [
            0.05,
            0.05,
            0.05,
            0.5,
            0.5,
            0.5
        ],
        "output_min": [
            -0.05,
            -0.05,
            -0.05,
            -0.5,
            -0.5,
            -0.5
        ],
        "position_limits": null,
        "ramp_ratio": 0.2,
        "type": "OSC_POSE",
        "uncouple_pos_ori": true
    },
    "has_offscreen_renderer": true,
    "has_renderer": false,
    "ignore_done": true,
    "render_gpu_device_id": 0,
    "reward_shaping": false,
    "robots": [
        "Panda"
    ],
    "use_camera_obs": false,
    "use_object_obs": true
}


============= Model Summary =============
ObservationKeyToModalityDict: action not found, adding action to mapping with assumed low_dim modality!
BC (
  ModuleDict(
    (policy): ActorNetwork(
        action_dim=7
  
        encoder=ObservationGroupEncoder(
            group=obs
            ObservationEncoder(
                Key(
                    name=object
                    shape=[14]
                    modality=low_dim
                    randomizer=None
                    net=None
                    sharing_from=None
                )
                Key(
                    name=robot0_eef_pos
                    shape=[3]
                    modality=low_dim
                    randomizer=None
                    net=None
                    sharing_from=None
                )
                Key(
                    name=robot0_eef_quat
                    shape=[4]
                    modality=low_dim
                    randomizer=None
                    net=None
                    sharing_from=None
                )
                Key(
                    name=robot0_gripper_qpos
                    shape=[2]
                    modality=low_dim
                    randomizer=None
                    net=None
                    sharing_from=None
                )
                output_shape=[23]
            )
        )
  
        mlp=MLP(
            input_dim=23
            output_dim=1024
            layer_dims=[1024]
            layer_func=Linear
            dropout=None
            act=ReLU
            output_act=ReLU
        )
  
        decoder=ObservationDecoder(
            Key(
                name=action
                shape=(7,)
                modality=low_dim
                net=(Linear(in_features=1024, out_features=7, bias=True))
            )
        )
    )
  )
)

SequenceDataset: loading dataset into memory...
  0%|          | 0/200 [00:00<?, ?it/s] 56%|#####5    | 111/200 [00:00<00:00, 1105.34it/s]100%|##########| 200/200 [00:00<00:00, 1112.01it/s]
SequenceDataset: caching get_item calls...
  0%|          | 0/30154 [00:00<?, ?it/s] 11%|#         | 3296/30154 [00:00<00:00, 32954.14it/s] 22%|##2       | 6683/30154 [00:00<00:00, 33488.54it/s] 33%|###3      | 10059/30154 [00:00<00:00, 33610.74it/s] 45%|####4     | 13421/30154 [00:00<00:00, 24709.44it/s] 56%|#####5    | 16739/30154 [00:00<00:00, 27191.42it/s] 66%|######6   | 20013/30154 [00:00<00:00, 28826.45it/s] 77%|#######7  | 23287/30154 [00:00<00:00, 29985.61it/s] 88%|########8 | 26562/30154 [00:00<00:00, 30807.53it/s] 99%|#########8| 29848/30154 [00:00<00:00, 31419.29it/s]100%|##########| 30154/30154 [00:01<00:00, 30127.19it/s]

============= Training Dataset =============
SequenceDataset (
	path=datasets/square/ph/low_dim_v141.hdf5
	obs_keys=('object', 'robot0_eef_pos', 'robot0_eef_quat', 'robot0_gripper_qpos')
	seq_length=1
	filter_key=none
	frame_stack=1
	pad_seq_length=True
	pad_frame_stack=True
	goal_mode=none
	cache_mode=all
	num_demos=200
	num_sequences=30154
)

**************************************************
Warnings generated by robomimic have been duplicated here (from above) for convenience. Please check them carefully.
[33mROBOMIMIC WARNING(
    No private macro file found!
    It is recommended to use a private macro file
    To setup, run: python /home/pa1077/robomimic/robomimic/scripts/setup_macros.py
)[0m
**************************************************

  0%|          | 0/100 [00:00<?, ?it/s]  1%|1         | 1/100 [00:00<01:06,  1.49it/s]  2%|2         | 2/100 [00:00<00:39,  2.49it/s]  3%|3         | 3/100 [00:01<00:30,  3.17it/s]  4%|4         | 4/100 [00:01<00:26,  3.63it/s]  5%|5         | 5/100 [00:01<00:24,  3.95it/s]  6%|6         | 6/100 [00:01<00:22,  4.16it/s]  7%|7         | 7/100 [00:01<00:21,  4.30it/s]  8%|8         | 8/100 [00:02<00:20,  4.41it/s]  9%|9         | 9/100 [00:02<00:19,  4.55it/s] 10%|#         | 10/100 [00:02<00:18,  4.76it/s] 11%|#1        | 11/100 [00:02<00:18,  4.93it/s] 12%|#2        | 12/100 [00:02<00:17,  5.06it/s] 13%|#3        | 13/100 [00:03<00:16,  5.17it/s] 14%|#4        | 14/100 [00:03<00:16,  5.26it/s] 15%|#5        | 15/100 [00:03<00:16,  5.31it/s] 16%|#6        | 16/100 [00:03<00:15,  5.34it/s] 17%|#7        | 17/100 [00:03<00:15,  5.34it/s] 18%|#8        | 18/100 [00:04<00:15,  5.36it/s] 19%|#9        | 19/100 [00:04<00:15,  5.36it/s] 20%|##        | 20/100 [00:04<00:14,  5.36it/s] 21%|##1       | 21/100 [00:04<00:14,  5.38it/s] 22%|##2       | 22/100 [00:04<00:14,  5.36it/s] 23%|##3       | 23/100 [00:04<00:14,  5.37it/s] 24%|##4       | 24/100 [00:05<00:14,  5.37it/s] 25%|##5       | 25/100 [00:05<00:13,  5.37it/s] 26%|##6       | 26/100 [00:05<00:13,  5.38it/s] 27%|##7       | 27/100 [00:05<00:13,  5.39it/s] 28%|##8       | 28/100 [00:05<00:13,  5.40it/s] 29%|##9       | 29/100 [00:06<00:13,  5.41it/s] 30%|###       | 30/100 [00:06<00:12,  5.41it/s] 31%|###1      | 31/100 [00:06<00:12,  5.41it/s] 32%|###2      | 32/100 [00:06<00:12,  5.41it/s] 33%|###3      | 33/100 [00:06<00:12,  5.41it/s] 34%|###4      | 34/100 [00:07<00:12,  5.42it/s] 35%|###5      | 35/100 [00:07<00:11,  5.42it/s] 36%|###6      | 36/100 [00:07<00:11,  5.42it/s] 37%|###7      | 37/100 [00:07<00:11,  5.42it/s] 38%|###8      | 38/100 [00:07<00:11,  5.42it/s] 39%|###9      | 39/100 [00:07<00:11,  5.41it/s] 40%|####      | 40/100 [00:08<00:11,  5.41it/s] 41%|####1     | 41/100 [00:08<00:10,  5.41it/s] 42%|####2     | 42/100 [00:08<00:10,  5.42it/s] 43%|####3     | 43/100 [00:08<00:10,  5.42it/s] 44%|####4     | 44/100 [00:08<00:10,  5.41it/s] 45%|####5     | 45/100 [00:09<00:10,  5.42it/s] 46%|####6     | 46/100 [00:09<00:09,  5.42it/s] 47%|####6     | 47/100 [00:09<00:09,  5.42it/s] 48%|####8     | 48/100 [00:09<00:09,  5.42it/s] 49%|####9     | 49/100 [00:09<00:09,  5.41it/s] 50%|#####     | 50/100 [00:09<00:09,  5.41it/s] 51%|#####1    | 51/100 [00:10<00:09,  5.42it/s] 52%|#####2    | 52/100 [00:10<00:08,  5.41it/s] 53%|#####3    | 53/100 [00:10<00:08,  5.42it/s] 54%|#####4    | 54/100 [00:10<00:08,  5.41it/s] 55%|#####5    | 55/100 [00:10<00:08,  5.42it/s] 56%|#####6    | 56/100 [00:11<00:08,  5.43it/s] 57%|#####6    | 57/100 [00:11<00:07,  5.42it/s] 58%|#####8    | 58/100 [00:11<00:07,  5.42it/s] 59%|#####8    | 59/100 [00:11<00:07,  5.42it/s] 60%|######    | 60/100 [00:11<00:07,  5.43it/s] 61%|######1   | 61/100 [00:11<00:07,  5.42it/s] 62%|######2   | 62/100 [00:12<00:07,  5.42it/s] 63%|######3   | 63/100 [00:12<00:06,  5.42it/s] 64%|######4   | 64/100 [00:12<00:06,  5.42it/s] 65%|######5   | 65/100 [00:12<00:06,  5.42it/s] 66%|######6   | 66/100 [00:12<00:06,  5.42it/s] 67%|######7   | 67/100 [00:13<00:06,  5.42it/s] 68%|######8   | 68/100 [00:13<00:05,  5.42it/s] 69%|######9   | 69/100 [00:13<00:05,  5.42it/s] 70%|#######   | 70/100 [00:13<00:05,  5.42it/s] 71%|#######1  | 71/100 [00:13<00:05,  5.42it/s] 72%|#######2  | 72/100 [00:14<00:05,  5.41it/s] 73%|#######3  | 73/100 [00:14<00:04,  5.42it/s] 74%|#######4  | 74/100 [00:14<00:04,  5.41it/s] 75%|#######5  | 75/100 [00:14<00:04,  5.41it/s] 76%|#######6  | 76/100 [00:14<00:04,  5.42it/s] 77%|#######7  | 77/100 [00:14<00:04,  5.42it/s] 78%|#######8  | 78/100 [00:15<00:04,  5.42it/s] 79%|#######9  | 79/100 [00:15<00:03,  5.41it/s] 80%|########  | 80/100 [00:15<00:03,  5.41it/s] 81%|########1 | 81/100 [00:15<00:03,  5.41it/s] 82%|########2 | 82/100 [00:15<00:03,  5.42it/s] 83%|########2 | 83/100 [00:16<00:03,  5.42it/s] 84%|########4 | 84/100 [00:16<00:02,  5.42it/s] 85%|########5 | 85/100 [00:16<00:02,  5.42it/s] 86%|########6 | 86/100 [00:16<00:02,  5.42it/s] 87%|########7 | 87/100 [00:16<00:02,  5.42it/s] 88%|########8 | 88/100 [00:16<00:02,  5.42it/s] 89%|########9 | 89/100 [00:17<00:02,  5.42it/s] 90%|######### | 90/100 [00:17<00:01,  5.43it/s] 91%|#########1| 91/100 [00:17<00:01,  5.43it/s] 92%|#########2| 92/100 [00:17<00:01,  5.42it/s] 93%|#########3| 93/100 [00:17<00:01,  5.42it/s] 94%|#########3| 94/100 [00:18<00:01,  5.42it/s] 95%|#########5| 95/100 [00:18<00:00,  5.42it/s] 96%|#########6| 96/100 [00:18<00:00,  5.42it/s] 97%|#########7| 97/100 [00:18<00:00,  5.42it/s] 98%|#########8| 98/100 [00:18<00:00,  5.31it/s] 99%|#########9| 99/100 [00:19<00:00,  5.18it/s]100%|##########| 100/100 [00:19<00:00,  5.24it/s]100%|##########| 100/100 [00:19<00:00,  5.20it/s]
Train Epoch 1
{
    "Cosine_Loss": 0.6439923325181007,
    "Jacobian": 221.54031205654144,
    "L1_Loss": 0.08315384149551391,
    "L2_Loss": 0.16830291852355003,
    "Loss": 221.708615026474,
    "Optimizer/policy0_lr": 0.0001,
    "Policy_Grad_Norms": 0.02493386195468702,
    "Time_Data_Loading": 0.002296777566274007,
    "Time_Epoch": 0.32040908336639407,
    "Time_Log_Info": 0.00020961761474609376,
    "Time_Process_Batch": 0.00026587645212809247,
    "Time_Train_Batch": 0.31744798421859743
}

Epoch 1 Memory Usage: 3543 MB

  0%|          | 0/100 [00:00<?, ?it/s]  1%|1         | 1/100 [00:00<00:18,  5.41it/s]  2%|2         | 2/100 [00:00<00:18,  5.41it/s]  3%|3         | 3/100 [00:00<00:17,  5.41it/s]  4%|4         | 4/100 [00:00<00:17,  5.41it/s]  5%|5         | 5/100 [00:00<00:17,  5.41it/s]  6%|6         | 6/100 [00:01<00:17,  5.41it/s]  7%|7         | 7/100 [00:01<00:17,  5.41it/s]  8%|8         | 8/100 [00:01<00:17,  5.40it/s]  9%|9         | 9/100 [00:01<00:16,  5.40it/s] 10%|#         | 10/100 [00:01<00:16,  5.40it/s] 11%|#1        | 11/100 [00:02<00:16,  5.40it/s] 12%|#2        | 12/100 [00:02<00:16,  5.40it/s] 13%|#3        | 13/100 [00:02<00:16,  5.41it/s] 14%|#4        | 14/100 [00:02<00:15,  5.41it/s] 15%|#5        | 15/100 [00:02<00:15,  5.41it/s] 16%|#6        | 16/100 [00:02<00:15,  5.41it/s] 17%|#7        | 17/100 [00:03<00:15,  5.41it/s] 18%|#8        | 18/100 [00:03<00:15,  5.41it/s] 19%|#9        | 19/100 [00:03<00:14,  5.40it/s] 20%|##        | 20/100 [00:03<00:14,  5.41it/s] 21%|##1       | 21/100 [00:03<00:14,  5.41it/s] 22%|##2       | 22/100 [00:04<00:14,  5.41it/s] 23%|##3       | 23/100 [00:04<00:14,  5.41it/s] 24%|##4       | 24/100 [00:04<00:14,  5.41it/s] 25%|##5       | 25/100 [00:04<00:13,  5.41it/s] 26%|##6       | 26/100 [00:04<00:13,  5.41it/s] 27%|##7       | 27/100 [00:04<00:13,  5.41it/s] 28%|##8       | 28/100 [00:05<00:13,  5.41it/s] 29%|##9       | 29/100 [00:05<00:13,  5.41it/s] 30%|###       | 30/100 [00:05<00:12,  5.41it/s] 31%|###1      | 31/100 [00:05<00:12,  5.41it/s] 32%|###2      | 32/100 [00:05<00:12,  5.41it/s] 33%|###3      | 33/100 [00:06<00:12,  5.41it/s] 34%|###4      | 34/100 [00:06<00:12,  5.41it/s] 35%|###5      | 35/100 [00:06<00:12,  5.40it/s] 36%|###6      | 36/100 [00:06<00:11,  5.40it/s] 37%|###7      | 37/100 [00:06<00:11,  5.41it/s] 38%|###8      | 38/100 [00:07<00:11,  5.41it/s] 39%|###9      | 39/100 [00:07<00:11,  5.41it/s] 40%|####      | 40/100 [00:07<00:11,  5.41it/s] 41%|####1     | 41/100 [00:07<00:10,  5.41it/s] 42%|####2     | 42/100 [00:07<00:10,  5.41it/s] 43%|####3     | 43/100 [00:07<00:10,  5.42it/s] 44%|####4     | 44/100 [00:08<00:10,  5.41it/s] 45%|####5     | 45/100 [00:08<00:10,  5.42it/s] 46%|####6     | 46/100 [00:08<00:09,  5.41it/s] 47%|####6     | 47/100 [00:08<00:09,  5.40it/s] 48%|####8     | 48/100 [00:08<00:09,  5.41it/s] 49%|####9     | 49/100 [00:09<00:09,  5.41it/s] 50%|#####     | 50/100 [00:09<00:09,  5.41it/s] 51%|#####1    | 51/100 [00:09<00:09,  5.41it/s] 52%|#####2    | 52/100 [00:09<00:08,  5.40it/s] 53%|#####3    | 53/100 [00:09<00:08,  5.40it/s] 54%|#####4    | 54/100 [00:09<00:08,  5.40it/s] 55%|#####5    | 55/100 [00:10<00:08,  5.40it/s] 56%|#####6    | 56/100 [00:10<00:08,  5.40it/s] 57%|#####6    | 57/100 [00:10<00:07,  5.40it/s] 58%|#####8    | 58/100 [00:10<00:07,  5.41it/s] 59%|#####8    | 59/100 [00:10<00:07,  5.41it/s] 60%|######    | 60/100 [00:11<00:07,  5.41it/s] 61%|######1   | 61/100 [00:11<00:07,  5.41it/s] 62%|######2   | 62/100 [00:11<00:07,  5.41it/s] 63%|######3   | 63/100 [00:11<00:06,  5.41it/s] 64%|######4   | 64/100 [00:11<00:06,  5.42it/s] 65%|######5   | 65/100 [00:12<00:06,  5.42it/s] 66%|######6   | 66/100 [00:12<00:06,  5.42it/s] 67%|######7   | 67/100 [00:12<00:06,  5.41it/s] 68%|######8   | 68/100 [00:12<00:05,  5.41it/s] 69%|######9   | 69/100 [00:12<00:05,  5.41it/s] 70%|#######   | 70/100 [00:12<00:05,  5.41it/s] 71%|#######1  | 71/100 [00:13<00:05,  5.43it/s] 72%|#######2  | 72/100 [00:13<00:05,  5.45it/s] 73%|#######3  | 73/100 [00:13<00:04,  5.46it/s] 74%|#######4  | 74/100 [00:13<00:04,  5.46it/s] 75%|#######5  | 75/100 [00:13<00:04,  5.46it/s] 76%|#######6  | 76/100 [00:14<00:04,  5.46it/s] 77%|#######7  | 77/100 [00:14<00:04,  5.46it/s] 78%|#######8  | 78/100 [00:14<00:04,  5.46it/s] 79%|#######9  | 79/100 [00:14<00:03,  5.46it/s] 80%|########  | 80/100 [00:14<00:03,  5.46it/s] 81%|########1 | 81/100 [00:14<00:03,  5.46it/s] 82%|########2 | 82/100 [00:15<00:03,  5.46it/s] 83%|########2 | 83/100 [00:15<00:03,  5.47it/s] 84%|########4 | 84/100 [00:15<00:02,  5.46it/s] 85%|########5 | 85/100 [00:15<00:02,  5.47it/s] 86%|########6 | 86/100 [00:15<00:02,  5.47it/s] 87%|########7 | 87/100 [00:16<00:02,  5.48it/s] 88%|########8 | 88/100 [00:16<00:02,  5.47it/s] 89%|########9 | 89/100 [00:16<00:02,  5.47it/s] 90%|######### | 90/100 [00:16<00:01,  5.46it/s] 91%|#########1| 91/100 [00:16<00:01,  5.46it/s] 92%|#########2| 92/100 [00:16<00:01,  5.46it/s] 93%|#########3| 93/100 [00:17<00:01,  5.47it/s] 94%|#########3| 94/100 [00:17<00:01,  5.47it/s] 95%|#########5| 95/100 [00:17<00:00,  5.47it/s] 96%|#########6| 96/100 [00:17<00:00,  5.47it/s] 97%|#########7| 97/100 [00:17<00:00,  5.47it/s] 98%|#########8| 98/100 [00:18<00:00,  5.47it/s] 99%|#########9| 99/100 [00:18<00:00,  5.47it/s]100%|##########| 100/100 [00:18<00:00,  5.46it/s]100%|##########| 100/100 [00:18<00:00,  5.43it/s]
Train Epoch 2
{
    "Cosine_Loss": 0.5756531840562821,
    "Jacobian": 1241.4683129882812,
    "L1_Loss": 0.06450645070523024,
    "L2_Loss": 0.13360668174922466,
    "Loss": 1241.6019152832032,
    "Optimizer/policy0_lr": 0.0001,
    "Policy_Grad_Norms": 0.02922663123035818,
    "Time_Data_Loading": 0.0022381703058878583,
    "Time_Epoch": 0.30719886620839437,
    "Time_Log_Info": 0.00022355318069458007,
    "Time_Process_Batch": 0.000262908140818278,
    "Time_Train_Batch": 0.30430588722229
}

Epoch 2 Memory Usage: 3544 MB

  0%|          | 0/100 [00:00<?, ?it/s]  1%|1         | 1/100 [00:00<00:18,  5.44it/s]  2%|2         | 2/100 [00:00<00:17,  5.45it/s]  3%|3         | 3/100 [00:00<00:17,  5.44it/s]  4%|4         | 4/100 [00:00<00:17,  5.43it/s]  5%|5         | 5/100 [00:00<00:17,  5.44it/s]  6%|6         | 6/100 [00:01<00:17,  5.43it/s]  7%|7         | 7/100 [00:01<00:17,  5.44it/s]  8%|8         | 8/100 [00:01<00:16,  5.43it/s]  9%|9         | 9/100 [00:01<00:16,  5.43it/s] 10%|#         | 10/100 [00:01<00:16,  5.43it/s] 11%|#1        | 11/100 [00:02<00:16,  5.42it/s] 12%|#2        | 12/100 [00:02<00:16,  5.43it/s] 13%|#3        | 13/100 [00:02<00:16,  5.42it/s] 14%|#4        | 14/100 [00:02<00:15,  5.42it/s] 15%|#5        | 15/100 [00:02<00:15,  5.42it/s] 16%|#6        | 16/100 [00:02<00:15,  5.42it/s] 17%|#7        | 17/100 [00:03<00:15,  5.43it/s] 18%|#8        | 18/100 [00:03<00:15,  5.43it/s] 19%|#9        | 19/100 [00:03<00:14,  5.42it/s] 20%|##        | 20/100 [00:03<00:14,  5.41it/s] 21%|##1       | 21/100 [00:03<00:14,  5.42it/s] 22%|##2       | 22/100 [00:04<00:14,  5.42it/s] 23%|##3       | 23/100 [00:04<00:14,  5.42it/s] 24%|##4       | 24/100 [00:04<00:14,  5.42it/s] 25%|##5       | 25/100 [00:04<00:13,  5.42it/s] 26%|##6       | 26/100 [00:04<00:13,  5.42it/s] 27%|##7       | 27/100 [00:04<00:13,  5.42it/s] 28%|##8       | 28/100 [00:05<00:13,  5.42it/s] 29%|##9       | 29/100 [00:05<00:13,  5.41it/s] 30%|###       | 30/100 [00:05<00:12,  5.41it/s] 31%|###1      | 31/100 [00:05<00:12,  5.41it/s] 32%|###2      | 32/100 [00:05<00:12,  5.42it/s] 33%|###3      | 33/100 [00:06<00:12,  5.41it/s] 34%|###4      | 34/100 [00:06<00:12,  5.42it/s] 35%|###5      | 35/100 [00:06<00:12,  5.41it/s] 36%|###6      | 36/100 [00:06<00:11,  5.42it/s] 37%|###7      | 37/100 [00:06<00:11,  5.41it/s] 38%|###8      | 38/100 [00:07<00:11,  5.41it/s] 39%|###9      | 39/100 [00:07<00:11,  5.42it/s] 40%|####      | 40/100 [00:07<00:11,  5.41it/s] 41%|####1     | 41/100 [00:07<00:10,  5.42it/s] 42%|####2     | 42/100 [00:07<00:10,  5.42it/s] 43%|####3     | 43/100 [00:07<00:10,  5.42it/s] 44%|####4     | 44/100 [00:08<00:10,  5.42it/s] 45%|####5     | 45/100 [00:08<00:10,  5.43it/s] 46%|####6     | 46/100 [00:08<00:09,  5.45it/s] 47%|####6     | 47/100 [00:08<00:09,  5.45it/s] 48%|####8     | 48/100 [00:08<00:09,  5.45it/s] 49%|####9     | 49/100 [00:09<00:09,  5.46it/s] 50%|#####     | 50/100 [00:09<00:09,  5.46it/s] 51%|#####1    | 51/100 [00:09<00:08,  5.46it/s] 52%|#####2    | 52/100 [00:09<00:08,  5.46it/s] 53%|#####3    | 53/100 [00:09<00:08,  5.47it/s] 54%|#####4    | 54/100 [00:09<00:08,  5.47it/s] 55%|#####5    | 55/100 [00:10<00:08,  5.47it/s] 56%|#####6    | 56/100 [00:10<00:08,  5.48it/s] 57%|#####6    | 57/100 [00:10<00:07,  5.47it/s] 58%|#####8    | 58/100 [00:10<00:07,  5.47it/s] 59%|#####8    | 59/100 [00:10<00:07,  5.47it/s] 60%|######    | 60/100 [00:11<00:07,  5.48it/s] 61%|######1   | 61/100 [00:11<00:07,  5.47it/s] 62%|######2   | 62/100 [00:11<00:06,  5.46it/s] 63%|######3   | 63/100 [00:11<00:06,  5.47it/s] 64%|######4   | 64/100 [00:11<00:06,  5.47it/s] 65%|######5   | 65/100 [00:11<00:06,  5.47it/s] 66%|######6   | 66/100 [00:12<00:06,  5.46it/s] 67%|######7   | 67/100 [00:12<00:06,  5.46it/s] 68%|######8   | 68/100 [00:12<00:05,  5.46it/s] 69%|######9   | 69/100 [00:12<00:05,  5.46it/s] 70%|#######   | 70/100 [00:12<00:05,  5.47it/s] 71%|#######1  | 71/100 [00:13<00:05,  5.46it/s] 72%|#######2  | 72/100 [00:13<00:05,  5.46it/s] 73%|#######3  | 73/100 [00:13<00:04,  5.46it/s] 74%|#######4  | 74/100 [00:13<00:04,  5.45it/s] 75%|#######5  | 75/100 [00:13<00:04,  5.46it/s] 76%|#######6  | 76/100 [00:13<00:04,  5.46it/s] 77%|#######7  | 77/100 [00:14<00:04,  5.46it/s] 78%|#######8  | 78/100 [00:14<00:04,  5.46it/s] 79%|#######9  | 79/100 [00:14<00:03,  5.46it/s] 80%|########  | 80/100 [00:14<00:03,  5.46it/s] 81%|########1 | 81/100 [00:14<00:03,  5.46it/s] 82%|########2 | 82/100 [00:15<00:03,  5.46it/s] 83%|########2 | 83/100 [00:15<00:03,  5.46it/s] 84%|########4 | 84/100 [00:15<00:02,  5.45it/s] 85%|########5 | 85/100 [00:15<00:02,  5.46it/s] 86%|########6 | 86/100 [00:15<00:02,  5.46it/s] 87%|########7 | 87/100 [00:15<00:02,  5.45it/s] 88%|########8 | 88/100 [00:16<00:02,  5.46it/s] 89%|########9 | 89/100 [00:16<00:02,  5.46it/s] 90%|######### | 90/100 [00:16<00:01,  5.47it/s] 91%|#########1| 91/100 [00:16<00:01,  5.46it/s] 92%|#########2| 92/100 [00:16<00:01,  5.46it/s] 93%|#########3| 93/100 [00:17<00:01,  5.46it/s] 94%|#########3| 94/100 [00:17<00:01,  5.46it/s] 95%|#########5| 95/100 [00:17<00:00,  5.45it/s] 96%|#########6| 96/100 [00:17<00:00,  5.45it/s] 97%|#########7| 97/100 [00:17<00:00,  5.45it/s] 98%|#########8| 98/100 [00:18<00:00,  5.46it/s] 99%|#########9| 99/100 [00:18<00:00,  5.45it/s]100%|##########| 100/100 [00:18<00:00,  5.45it/s]100%|##########| 100/100 [00:18<00:00,  5.44it/s]
Train Epoch 3
{
    "Cosine_Loss": 0.5356504330039025,
    "Jacobian": 3100.71193359375,
    "L1_Loss": 0.05489896364510059,
    "L2_Loss": 0.1132914450019598,
    "Loss": 3100.8252111816405,
    "Optimizer/policy0_lr": 0.0001,
    "Policy_Grad_Norms": 0.03553146808917518,
    "Time_Data_Loading": 0.00223466952641805,
    "Time_Epoch": 0.3061644911766052,
    "Time_Log_Info": 0.00022430817286173504,
    "Time_Process_Batch": 0.00026145378748575844,
    "Time_Train_Batch": 0.3032747308413188
}

Epoch 3 Memory Usage: 3544 MB

  0%|          | 0/100 [00:00<?, ?it/s]  1%|1         | 1/100 [00:00<00:18,  5.46it/s]  2%|2         | 2/100 [00:00<00:17,  5.45it/s]  3%|3         | 3/100 [00:00<00:17,  5.46it/s]  4%|4         | 4/100 [00:00<00:17,  5.47it/s]  5%|5         | 5/100 [00:00<00:17,  5.47it/s]  6%|6         | 6/100 [00:01<00:17,  5.46it/s]  7%|7         | 7/100 [00:01<00:17,  5.46it/s]  8%|8         | 8/100 [00:01<00:16,  5.47it/s]  9%|9         | 9/100 [00:01<00:16,  5.46it/s] 10%|#         | 10/100 [00:01<00:16,  5.46it/s] 11%|#1        | 11/100 [00:02<00:16,  5.46it/s] 12%|#2        | 12/100 [00:02<00:16,  5.46it/s] 13%|#3        | 13/100 [00:02<00:15,  5.47it/s] 14%|#4        | 14/100 [00:02<00:15,  5.46it/s] 15%|#5        | 15/100 [00:02<00:15,  5.46it/s] 16%|#6        | 16/100 [00:02<00:15,  5.45it/s] 17%|#7        | 17/100 [00:03<00:15,  5.46it/s] 18%|#8        | 18/100 [00:03<00:15,  5.45it/s] 19%|#9        | 19/100 [00:03<00:14,  5.46it/s] 20%|##        | 20/100 [00:03<00:14,  5.45it/s] 21%|##1       | 21/100 [00:03<00:14,  5.46it/s] 22%|##2       | 22/100 [00:04<00:14,  5.46it/s] 23%|##3       | 23/100 [00:04<00:14,  5.46it/s] 24%|##4       | 24/100 [00:04<00:13,  5.46it/s] 25%|##5       | 25/100 [00:04<00:13,  5.46it/s] 26%|##6       | 26/100 [00:04<00:13,  5.45it/s] 27%|##7       | 27/100 [00:04<00:13,  5.46it/s] 28%|##8       | 28/100 [00:05<00:13,  5.45it/s] 29%|##9       | 29/100 [00:05<00:13,  5.46it/s] 30%|###       | 30/100 [00:05<00:12,  5.46it/s] 31%|###1      | 31/100 [00:05<00:12,  5.46it/s] 32%|###2      | 32/100 [00:05<00:12,  5.45it/s] 33%|###3      | 33/100 [00:06<00:12,  5.45it/s] 34%|###4      | 34/100 [00:06<00:12,  5.46it/s] 35%|###5      | 35/100 [00:06<00:11,  5.46it/s] 36%|###6      | 36/100 [00:06<00:11,  5.46it/s] 37%|###7      | 37/100 [00:06<00:11,  5.45it/s] 38%|###8      | 38/100 [00:06<00:11,  5.46it/s] 39%|###9      | 39/100 [00:07<00:11,  5.45it/s] 40%|####      | 40/100 [00:07<00:11,  5.45it/s] 41%|####1     | 41/100 [00:07<00:10,  5.45it/s] 42%|####2     | 42/100 [00:07<00:10,  5.45it/s] 43%|####3     | 43/100 [00:07<00:10,  5.45it/s] 44%|####4     | 44/100 [00:08<00:10,  5.45it/s] 45%|####5     | 45/100 [00:08<00:10,  5.44it/s] 46%|####6     | 46/100 [00:08<00:09,  5.44it/s] 47%|####6     | 47/100 [00:08<00:09,  5.44it/s] 48%|####8     | 48/100 [00:08<00:09,  5.43it/s] 49%|####9     | 49/100 [00:08<00:09,  5.43it/s] 50%|#####     | 50/100 [00:09<00:09,  5.43it/s] 51%|#####1    | 51/100 [00:09<00:09,  5.43it/s] 52%|#####2    | 52/100 [00:09<00:08,  5.43it/s] 53%|#####3    | 53/100 [00:09<00:08,  5.43it/s] 54%|#####4    | 54/100 [00:09<00:08,  5.43it/s] 55%|#####5    | 55/100 [00:10<00:08,  5.43it/s] 56%|#####6    | 56/100 [00:10<00:08,  5.42it/s] 57%|#####6    | 57/100 [00:10<00:07,  5.42it/s] 58%|#####8    | 58/100 [00:10<00:07,  5.42it/s] 59%|#####8    | 59/100 [00:10<00:07,  5.42it/s] 60%|######    | 60/100 [00:11<00:07,  5.42it/s] 61%|######1   | 61/100 [00:11<00:07,  5.41it/s] 62%|######2   | 62/100 [00:11<00:07,  5.42it/s] 63%|######3   | 63/100 [00:11<00:06,  5.42it/s] 64%|######4   | 64/100 [00:11<00:06,  5.42it/s] 65%|######5   | 65/100 [00:11<00:06,  5.42it/s] 66%|######6   | 66/100 [00:12<00:06,  5.42it/s] 67%|######7   | 67/100 [00:12<00:06,  5.43it/s] 68%|######8   | 68/100 [00:12<00:05,  5.42it/s] 69%|######9   | 69/100 [00:12<00:05,  5.42it/s] 70%|#######   | 70/100 [00:12<00:05,  5.42it/s] 71%|#######1  | 71/100 [00:13<00:05,  5.43it/s] 72%|#######2  | 72/100 [00:13<00:05,  5.42it/s] 73%|#######3  | 73/100 [00:13<00:04,  5.42it/s] 74%|#######4  | 74/100 [00:13<00:04,  5.42it/s] 75%|#######5  | 75/100 [00:13<00:04,  5.42it/s] 76%|#######6  | 76/100 [00:13<00:04,  5.42it/s] 77%|#######7  | 77/100 [00:14<00:04,  5.42it/s] 78%|#######8  | 78/100 [00:14<00:04,  5.41it/s] 79%|#######9  | 79/100 [00:14<00:03,  5.42it/s] 80%|########  | 80/100 [00:14<00:03,  5.42it/s] 81%|########1 | 81/100 [00:14<00:03,  5.42it/s] 82%|########2 | 82/100 [00:15<00:03,  5.42it/s] 83%|########2 | 83/100 [00:15<00:03,  5.42it/s] 84%|########4 | 84/100 [00:15<00:02,  5.41it/s] 85%|########5 | 85/100 [00:15<00:02,  5.41it/s] 86%|########6 | 86/100 [00:15<00:02,  5.41it/s] 87%|########7 | 87/100 [00:15<00:02,  5.41it/s] 88%|########8 | 88/100 [00:16<00:02,  5.41it/s] 89%|########9 | 89/100 [00:16<00:02,  5.41it/s] 90%|######### | 90/100 [00:16<00:01,  5.42it/s] 91%|#########1| 91/100 [00:16<00:01,  5.42it/s] 92%|#########2| 92/100 [00:16<00:01,  5.42it/s] 93%|#########3| 93/100 [00:17<00:01,  5.42it/s] 94%|#########3| 94/100 [00:17<00:01,  5.42it/s] 95%|#########5| 95/100 [00:17<00:00,  5.42it/s] 96%|#########6| 96/100 [00:17<00:00,  5.42it/s] 97%|#########7| 97/100 [00:17<00:00,  5.41it/s] 98%|#########8| 98/100 [00:18<00:00,  5.41it/s] 99%|#########9| 99/100 [00:18<00:00,  5.41it/s]100%|##########| 100/100 [00:18<00:00,  5.41it/s]100%|##########| 100/100 [00:18<00:00,  5.44it/s]
Train Epoch 4
{
    "Cosine_Loss": 0.4851966559886932,
    "Jacobian": 5868.998706054687,
    "L1_Loss": 0.048275486305356025,
    "L2_Loss": 0.09909921891987324,
    "Loss": 5869.097819824219,
    "Optimizer/policy0_lr": 0.0001,
    "Policy_Grad_Norms": 0.03517387665018759,
    "Time_Data_Loading": 0.0022364695866902667,
    "Time_Epoch": 0.3066433032353719,
    "Time_Log_Info": 0.00022464195887247722,
    "Time_Process_Batch": 0.0002634604771931966,
    "Time_Train_Batch": 0.3037511785825094
}

Epoch 4 Memory Usage: 3544 MB

  0%|          | 0/100 [00:00<?, ?it/s]  1%|1         | 1/100 [00:00<00:18,  5.40it/s]  2%|2         | 2/100 [00:00<00:18,  5.42it/s]  3%|3         | 3/100 [00:00<00:17,  5.42it/s]  4%|4         | 4/100 [00:00<00:17,  5.42it/s]  5%|5         | 5/100 [00:00<00:17,  5.41it/s]  6%|6         | 6/100 [00:01<00:17,  5.41it/s]  7%|7         | 7/100 [00:01<00:17,  5.40it/s]  8%|8         | 8/100 [00:01<00:17,  5.41it/s]  9%|9         | 9/100 [00:01<00:16,  5.41it/s] 10%|#         | 10/100 [00:01<00:16,  5.42it/s] 11%|#1        | 11/100 [00:02<00:16,  5.42it/s] 12%|#2        | 12/100 [00:02<00:16,  5.42it/s] 13%|#3        | 13/100 [00:02<00:16,  5.42it/s] 14%|#4        | 14/100 [00:02<00:15,  5.43it/s] 15%|#5        | 15/100 [00:02<00:15,  5.42it/s] 16%|#6        | 16/100 [00:02<00:15,  5.42it/s] 17%|#7        | 17/100 [00:03<00:15,  5.41it/s] 18%|#8        | 18/100 [00:03<00:15,  5.41it/s] 18%|#8        | 18/100 [00:03<00:15,  5.22it/s]
Traceback (most recent call last):
  File "robomimic/scripts/train.py", line 430, in <module>
    main(args)
  File "robomimic/scripts/train.py", line 377, in main
    train(config, device=device)
  File "robomimic/scripts/train.py", line 195, in train
    step_log = TrainUtils.run_epoch(
  File "/home/pa1077/robomimic/robomimic/utils/train_utils.py", line 559, in run_epoch
    info = model.train_on_batch(input_batch, epoch, validate=validate)
  File "/home/pa1077/robomimic/robomimic/algo/bc.py", line 179, in train_on_batch
    losses = self._compute_losses(predictions, batch)
  File "/home/pa1077/robomimic/robomimic/algo/bc.py", line 271, in _compute_losses
    losses["Jacobian"] = Jloss(predictions, batch, self)
  File "/home/pa1077/miniconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/pa1077/robomimic/robomimic/algo/bc.py", line 797, in forward
    msv[fcount] = torch.square(torch.sum(temp.mjv(i)))
  File "/home/pa1077/robomimic/robomimic/models/obs_nets.py", line 605, in mjv
    return torch.autograd.functional.jacobian(self.Jacobian_helper, (enc_output))
  File "/home/pa1077/miniconda3/lib/python3.8/site-packages/torch/autograd/functional.py", line 686, in jacobian
    vj = _autograd_grad((out.reshape(-1)[j],), inputs,
  File "/home/pa1077/miniconda3/lib/python3.8/site-packages/torch/autograd/functional.py", line 167, in _autograd_grad
    return torch.autograd.grad(new_outputs, inputs, new_grad_outputs, allow_unused=True,
  File "/home/pa1077/miniconda3/lib/python3.8/site-packages/torch/autograd/__init__.py", line 303, in grad
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
